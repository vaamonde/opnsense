Autor: Robson Vaamonde
Procedimentos em TI: http://procedimentosemti.com.br
Bora para Prática: http://boraparapratica.com.br
Robson Vaamonde: http://vaamonde.com.br
Facebook Procedimentos em TI: https://www.facebook.com/ProcedimentosEmTi
Facebook Bora para Prática: https://www.facebook.com/BoraParaPratica
Instagram Procedimentos em TI: https://www.instagram.com/procedimentoem
YouTUBE Bora Para Prática: https://www.youtube.com/boraparapratica
LinkedIn Robson Vaamonde: https://www.linkedin.com/in/robson-vaamonde-0b029028/
Data de criação: 28/03/2021
Data de atualização: 28/03/2021
Versão: 0.01
Testado e homologado no Firewall NGFW UTM OPNsense 21.x

Seleção do Hardware do OPNsense: https://docs.opnsense.org/manual/hardware.html

Servidores de DNS recomendados para serem utilizados no pfSense
DNS Google..............: Preferencial: 8.8.8.8 - Secundário: 8.8.4.4
OpenDNS Cisco...........: Preferencial: 208.67.222.222 - Secundário: 208.67.220.220
OpenDNS FamilyShield....: Preferencial: 208.67.222.123 - Secundário: 208.67.220.123
CloudFlare..............: Preferencial: 1.1.1.1 - Secundário: 1.0.0.1
CloudFlare FamilyShield.: Preferencial: 1.1.1.3 - Secundário: 1.0.0.3

Primeira etapa: Download da ISO do NGFW UTM OPNsense
01. Link de download do OPNsense: https://opnsense.org/download/
02. Versão do download OPNsense: 21.1 (28/03/2021)
03. Arquitetura do OPNsense: AMD64 (64-bit)
04. Tipo de instalação: DVD Image (ISO) Installer
05. Mirror padrão do download: Brazil, Cloudfence
06. Arquivo compactado utilizando o BZ2 (Bzip2)
07. Extrair o conteúdo do arquivo compactado para utilizar a ISO do OPNsense
08. Dica: se você utiliza o Microsoft Windows recomendo instalar o 7Zip: https://www.7-zip.org/download.html

Segunda etapa: Criação e Configuração da Máquina Virtual no Oracle VirtualBOX
Link de download do Oracle VirtualBOX: https://www.virtualbox.org/wiki/Downloads
01. Ferramentas;
	Novo
02. Nome e Sistema Operacional:
	Nome: OPNsense
	Pasta da Máquina: (deixar o padrão do sistema) 
	Tipo: BSD
	Versão: FreeBSD (64-bit)
	<Próximo>
03. Tamanho da memória:
	Tamanho: 1024MB
	<Próximo>
04. Disco Rígido:
	Criar um novo disco rígido virtual agora
	<Criar>
05. Tipo de arquivo de disco rígido
	VDI (VirtualBOX Disk Image)
	<Próximo>
06. Armazenamento em disco rígido físico
	Dinamicamente alocado
	<Próximo>
07. Localização e tamanho do arquivo
	Localização: (deixar o padrão do sistema)
	Tamanho do disco: 16GB
	<Criar>
04. Configurações da Máquina Virtual OPNsense (Propriedades/Configurações)
	Sistema
		Processador
			Processadores: 02 CPUs
			Recursos Estendidos: Habilitar PAE/NX
	Monitor
		Tela
			Memória de Vídeo: 128MB
			Aceleração: Habilitar Aceleração 3D
	Áudio
		Habilitar Áudio: Desabilitar
	Rede
		Adaptador 1 (LAN)
			Habilitar Placa de Rede
			Conectado a: Rede Interna
			Nome: (deixar o padrão do sistema: intnet)
		Adaptador 2 (WAN)
			Habilitar Placa de Rede
			Conectado a: Placa em Modo Bridge
			Nome: (Interface padrão de acesso a Internet e Rede Local do Hospedeiro)
<OK>

Instalação do OPNsense: https://docs.opnsense.org/manual/install.html

Terceira etapa: Instalação do OPNsense (localizar a ISO descompactada)
01. VM OPNsense: Iniciar
02. Selecione o disco rígido de boot
	Selecionar um arquivo de disco óptico virtual
03. Seletor de Discos Ópticos
	Acrescentar
	Selecione o arquivo de disco óptico virtual: OPNsense-21.1-OpenSSL-dvd-amd64.iso
	<Abrir>
04. Not Attached
	Selecionar: OPNsense-21.1-OpenSSL-dvd-amd64.iso
	<Escolher>
<Iniciar>

Observação: No Oracle VirtualBOX existe uma falha onde o CD-Room do OPNsense não é ejetado 
no final da Instalação, sendo necessário desmontar o CD-Room e rebotar a máquina virtual.